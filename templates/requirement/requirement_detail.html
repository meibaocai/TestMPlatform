{% extends 'base.html' %}{% load staticfiles %}{% block title %}    首页-测试管理平台{% endblock %}{% block page_title %}    <ul class="breadcrumb">        <li>            <i class="icon-home"></i>            <a href="/index">Home</a>            <i class="icon-angle-right"></i>        </li>        <li><a href="{% url 'requirement:RequirementList' %}">需求管理 > 需求详情</a></li>    </ul>{% endblock %}{% block contend %}<div class="portlet-body form">    <!-- BEGIN FORM-->    <form action="/requirement/RequirementDetail/{{ requirements.id }}/" id="form_sample_1" class="form-horizontal"  method="get" enctype="multipart/form-data">        {% csrf_token %}        <div class="control-group">            <label class="control-label">需求主题<span class="required">*</span></label>            <div class="controls">                <input type="text" disabled="disabled" name="requirement_name" data-required="1" class="span6 m-wrap" value="{{ requirements.name }}">            </div>        </div>        <div class="control-group">            <label class="control-label">所属版本<span class="required">*</span></label>            <div class="controls">                <select class="span6 m-wrap" name="belong_version" disabled="disabled">                    <option value="">请选择所属版本</option>                    <option value="{{ requirements.belong_version.id }}" selected="selected">{{ requirements.belong_version.version_name }}</option>                </select>            </div>        </div>        <div class="Djangoueditor" style="" >            <label class="control-label">需求描述<span class="required">*&nbsp;&nbsp;</span></label>                        <div class="controls" disabled="disabled"  style="overflow:scroll; border:1px solid #e5dddb;width: 1030px;height: 535px;" ><!-- 直接显示富文本里面的内容-->                            {% autoescape off %}                               {{ requirements.detail |safe}}                            {% endautoescape %}                        <!-- 显示富文本编辑框                            {{ form.media }}                            {{ form.detail }}                        -->                        </div>        </div>        <div class="control-group"style="margin-top: 10px;">            <p></p>            <label class="control-label">产品负责人<span class="required">*</span></label>            <div class="controls">                <select class="span6 m-wrap" name="creator" disabled="disabled">                    <option value="{{ requirements.creator }}" selected="selected">{{ requirements.creator }}</option>                </select>            </div>        </div>        <div class="control-group">            <label class="control-label">需求负责人<span class="required">&nbsp;</span></label>            <div class="controls">                <select class="span6 m-wrap" name="solver" disabled="disabled">                    <option value="">请选择需求负责人</option>                    <option value="{{ requirements.solver }}" selected="selected">{{ requirements.solver }}</option>                </select>            </div>        </div>        <div class="control-group">            <label class="control-label">测试负责人<span class="required">&nbsp;</span></label>            <div class="controls">                <select class="span6 m-wrap" name="tester" disabled="disabled">                    <option value="">请选择测试负责人</option>                    <option value="{{ requirements.tester }}" selected="selected">{{ requirements.tester }}</option>                </select>            </div>            <label class="control-label" style="margin-top: 15px">状态<span class="required">&nbsp;</span></label>            <div class="controls">                <select class="span6 m-wrap" id="requirement_status"name="requirement_status" style="margin-top: 15px">                    <option value="{{ requirements.status }}" selected="selected">{{ requirements.get_status_display }}</option>                    <option value="1">新建</option>                    <option value="2">开发中</option>                    <option value="3">测试验收</option>                    <option value="4">验收完成</option>                    <option value="5">暂停</option>                </select>            </div>        </div>        <div class="form-actions">        <a href="javascript:history.go(-1)">                <button type="button green" class="btn green" onclick="ChangeRequirementStatus()">更改需求状态</button>            </a>            <a href="javascript:history.go(-1)" style="margin-left: 30px">                <button type="button" class="btn">返回</button>            </a>        </div>        <div class="control-group" >            <H4  style="color: #1b23ff" align="center">{{ msg }}</H4>            <b style="color: #4b4cff">{% for key,error in form.errors.items %}{{ key }}{{ error }}{% endfor %}</b>        </div>    </form>    <!-- END FORM--></div>{% endblock %}{% block myjs %}	<script>		jQuery(document).ready(function() {		   App.init(); // initlayout and core plugins           var edit=document.getElementById("id_detail");           edit.setAttribute("readonly", true);        });		function ChangeRequirementStatus() {		    var Requirement_Status =$("#requirement_status").val();		    var Requirement_id ={{ requirements.id |safe}}		    //alert(Requirement_Status)            $.ajax({                    type: 'post',                    url: '/requirement/ChangeRequirementStatus',                    traditional:true,                    data: {                        "requirement_id":Requirement_id,                        "requirement_status":Requirement_Status,                       },                    timeout: 5000, //超时时间设置，单位毫秒                    beforeSend: function (xhr, settings) {                        xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");                        },                    success: function (res) {                           if (res.code == 200) {                               //返回上一页并刷新：                            window.location.href = document.referrer;                        }                           else{                               alert(res.msg)                           }                    }                });        }	</script>	<!-- END JAVASCRIPTS -->{% endblock %}