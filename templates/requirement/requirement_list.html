{% extends 'base.html' %}{% load staticfiles %}{% block title %}    首页-测试管理平台{% endblock %}{% block page_title %}    <ul class="breadcrumb">        <li>            <i class="icon-home"></i>            <a href="/index">Home</a>            <i class="icon-angle-right"></i>        </li>        <li><a href="{% url 'requirement:RequirementList' %}">需求管理 > 需求列表</a></li>    </ul>{% endblock %}{% block contend %}    <div class="portlet-body">            {% csrf_token %}            <div class="clearfix">                <div class="btn-group">                                    <a href="{% url 'requirement:AddRequirement' %}" style="margin-left: 10px;">										<button id="sample_editable_1_new" class="btn green">										新增需求 <i class="icon-plus"></i>										</button>                                        </a>                                    <a href="#testAlert"  role="button" class="btn red"  data-toggle="modal" style="margin-left: 10px;">										删除需求 <i class="icon-minus"></i>										</button>                                    </a>                </div>                <form action="{% url 'requirement:SearchMyRequirement' %}" id="form_sample_1" class="form-inline"  method="get" enctype="multipart/form-data" style="margin-top:15px;">                {% csrf_token %}                    <input type="hidden" id="requirement_channel"  name="requirement_channel" value="everyone">                <label class="control-label">需求ID：</label>                <input type="text" name="requirement_id" id="requirement_id" value="{{ requirement_id }}" style="width:80px;">                <label class="control-label" style="margin-left: 30px">需求名称：</label>                <input type="text" name="search_key" id="search_key" value="{{ search_key }}" style="width:100px;">                <label class="control-label" style="margin-left:30px">版本：</label>                <select class="selectpicker" id="belong_version" name="belong_version"  multiple data-live-search="true" data-max-options="1"style="width:120px;" title="--请选择版本--">                    <option value=""></option>                    {% for version in all_version %}                        <option value="{{ version.id }}">{{ version.version_name }}</option>                    {% endfor %}                </select>                <label class="control-label" style="margin-left:30px">状态：</label>                <select class="selectpicker" id="requirement_status" name="requirement_status" multiple data-max-options="1" style="width:80px;margin-top:15px;" title="--请选择状态--">                    <option value=""></option>                    <option value="0">删除</option>                    <option value="1">新建</option>                    <option value="2">开发中</option>                    <option value="3">测试验收</option>                    <option value="4">验收完成</option>                    <option value="5">暂停</option>                </select>                <button type="submit" class="btn green "  style="margin-left:30px;">搜索</button>            </form>            </div>            <table class="table table-striped table-bordered table-hover" id="sample_1">                <thead>                    <tr>                        <th style="width:8px;"><input type="checkbox" id="firstCheckBox" class="group-checkable" data-set="#sample_1 .checkboxes" /></th>                        <th>需求ID</th>                        <th>需求标题</th>                        <th class="hidden-480">所属版本</th>                        <th class="hidden-480">产品负责人</th>                        <th class="hidden-480">需求负责人</th>                        <th class="hidden-480">测试对接人</th>                        <th class="hidden-480">状态</th>                        <th class="hidden-480">创建时间</th>                        <th class="hidden-480">操作</th>                    </tr>                </thead>                    <tbody>                        {% for requirement in pages %}                            <tr class="odd gradeX">                                    <td><input type="checkbox" class="checkboxes" name="checkbox" value="{{ requirement.id }}" /></td>                                    <td class="hidden-480" style="color: #246ee5" >                                        <a href="/requirement/RequirementDetail/{{ requirement.id  }}">{{ requirement.id }}</a>                                    </td>                                    <td class="hidden-480" style="color: #246ee5" >                                        <a href="/requirement/RequirementDetail/{{ requirement.id  }}">{{ requirement.name }}</a>                                    </td>                                    <td class="hidden-480">{{ requirement.belong_version.version_name}}</td>                                    <td class="hidden-480">{{ requirement.creator }}</td>                                    <td class="hidden-480">{{ requirement.solver }}</td>                                    <td class="hidden-480">{{ requirement.tester }}</td>                                    <td class="hidden-480">{{ requirement.get_status_display }}</td>                                    <td class="hidden-480">{{ requirement.add_time }}</td>                                    <td class="center hidden-480">                                        <a href="/requirement/ModifyRequirement/{{ requirement.id  }}">修改</a>                                    </td>                            </tr>                        {% endfor %}                            <table class="table">                                <ul class="breadcrumb">                                    {% if pages.has_previous %}                                      <li class="long">                                        <a href="?requirement_channel=everyone&requirement_id={{ requirement_id }}&search_key={{ search_key }}&belong_version={{ belong_version }}&requirement_status={{ requirement_status }}&page_num={{ pages.previous_page_number }}">上一页</a>                                      </li>                                  {% endif %}                                    {% for num in pages.paginator.page_range %}                                        <li {% if num == pages.number %}class="active" {% endif %}><a href="?requirement_channel=everyone&requirement_id={{ requirement_id }}&search_key={{ search_key }}&belong_version={{ belong_version }}&requirement_status={{ requirement_status }}&page_num={{ num }}">{{ num }}</a></li>                                    {% endfor %}                                    {% if pages.has_next %}                                        <li class="long" >                                            <a href="?requirement_channel=everyone&requirement_id={{ requirement_id }}&search_key={{ search_key }}&belong_version={{ belong_version }}&requirement_status={{ requirement_status }}&page_num={{ pages.next_page_number }}">下一页</a>                                        </li>                                    {% endif %}                                </ul>                            </table>                    </tbody>            </table>    </div>    <!--弹框 -->    <div id="testAlert" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel3" aria-hidden="true">                                <div class="modal-header">                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>                                    <h3 id="myModalLabel3">警告</h3>                                </div>                                <div class="modal-body">                                    <p>是否确定删除该需求</p>                                </div>                                <div class="modal-footer">                                    <button class="btn" data-dismiss="modal" aria-hidden="true">取消</button>                                    <input type="button" id="testDel" data-dismiss="modal" class="btn blue" value="确认">                                </div>                            </div>{% endblock %}{% block myjs %}<script>     $("#requirement_status").selectpicker('val',"{{ requirement_status|safe }}" );4     $("#belong_version").selectpicker('val',"{{ belong_version|safe }}" );        $("#testDel").on('click', function() {        check_val = [];        $(":checkbox:checked").each(function () {            if (this.value != '') {                check_val.push(this.value);            }        });        var checkValue = eval(check_val);        if (checkValue == '') {            alert("请选择一条记录");            window.location.reload()            return;        }        if (checkValue.length>1)        {            alert("只能选择一条记录");            window.location.reload()            return;        }        $.ajax({            type: 'POST',            url: '/requirement/DelRequirement',            data:{                "requirement_id":checkValue[0],            },            beforeSend:function(xhr, settings){                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");            },            success: function (callback) {                alert(callback.msg)                window.location.reload();            }        });    });</script>{% endblock %}