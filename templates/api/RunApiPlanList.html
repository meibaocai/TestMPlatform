{% extends 'base.html' %}{% load staticfiles %}{% block title %}    首页-测试管理平台{% endblock %}{% block page_title %}    <ul class="breadcrumb">        <li>            <i class="icon-home"></i>            <a href="/index">Home</a>            <i class="icon-angle-right"></i>        </li>        <li><a href="{% url 'api:RunApiPlanInfo' %}">API自动化 >CI执行报告</a></li>    </ul>{% endblock %}{% block contend %}    <div class="portlet-body">            {% csrf_token %}        <div class="clearfix">                <div class="btn-group">                                    <a href="#testAlert"  role="button" class="btn red"  data-toggle="modal" style="margin-left: 10px;">										删除记录 <i class="icon-minus"></i>                                    </a>                </div>            </div>            <div id="testAlert" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel3" aria-hidden="true">                                <div class="modal-header">                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>                                    <h3 id="myModalLabel3">警告</h3>                                </div>                                <div class="modal-body">                                    <p>是否确定删除该计划</p>                                </div>                                <div class="modal-footer">                                    <button class="btn" data-dismiss="modal" aria-hidden="true">取消</button>                                    <input type="button" id="testDel" data-dismiss="modal" class="btn blue" value="确认">                                </div>            </div>            <table class="table table-striped table-bordered table-hover" id="sample_1">                <thead>                    <tr>                        <th style="width:8px;"><input type="checkbox" class="group-checkable" data-set="#sample_1 .checkboxes" /></th>                        <th>ID</th>                        <th>CI名称</th>                        <th>运行批次号</th>                        <th class="hidden-480">执行者</th>                        <th class="hidden-480">运行结果</th>                        <th class="hidden-480">开始时间</th>                        <th class="hidden-480">结束时间</th>                    </tr>                </thead>                    <tbody>                        {% for plans in pages %}                            <tr class="odd gradeX">                                    <td><input type="checkbox" class="checkboxes" value="{{ plans.id }}" /></td>                                    <td class="hidden-480">{{ plans.id }}</td>                                    <td class="hidden-480" style="color: #246ee5">                                     <a href="/api/RunApiResultList/?run_type=2&case_id=&run_batch={{ plans.run_batch }}">{{ plans.name }}</a>                                    </td>                                    <td class="hidden-480">{{ plans.run_batch }}</td>                                    <td class="hidden-480">{{ plans.run_user}}</td>                                    <td class="hidden-480">                                        <strong>                                            <font size="2" color="#b22222">成功率 {{ plans.success_ratio}}%</font>                                            <font size="2" color="green">成功 {{ plans.success_num}}</font>                                            <font size="2" color="red">失败 {{ plans.fail_num }}</font>                                            <font size="2" color="#6495ed">用例总数 {{ plans.case_num }}</font></strong> </td>                                    <td class="hidden-480">{{ plans.start_time|safe }}</td>                                    <td class="hidden-480">{{ plans.end_time|safe }}</td>                        {% endfor %}                            <table class="table">                                <ul class="breadcrumb">                                    {% if pages.has_previous %}                                      <li class="long">                                        <a href="?page_num={{ pages.previous_page_number }}">上一页</a>                                      </li>                                  {% endif %}                                    {% for num in pages.paginator.page_range %}                                        <li {% if num == pages.number %}class="active" {% endif %}><a href="?page_num={{ num }}">{{ num }}</a></li>                                    {% endfor %}                                    {% if pages.has_next %}                                        <li class="long" >                                            <a href="?page_num={{ pages.next_page_number }}">下一页</a>                                        </li>                                    {% endif %}                                </ul>                            </table>                    </tbody>            </table>    </div>    {% endblock %}{% block myjs %}<script>    jQuery('#sample_1 .group-checkable').change(function () {                var set = jQuery(this).attr("data-set");                var checked = jQuery(this).is(":checked");                jQuery(set).each(function () {                    if (checked) {                        $(this).attr("checked", true);                    } else {                        $(this).attr("checked", false);                    }                });                jQuery.uniform.update(set);            });        $("#testDel").on('click', function() {        check_val = [];        $(":checkbox:checked").each(function () {            if (this.value != '') {                check_val.push(this.value);            }            if (this.value == 'on'){                check_val.shift(this.value);            }        });        var checkValue = eval(check_val);        if (checkValue == '') {            alert("请选择一条记录");            window.location.reload()            return;        }        $.ajax({            type: 'post',            url: '/api/DelRunApiPlan/',            data:{                "plan_id":JSON.stringify(checkValue),            },            beforeSend:function(xhr, settings){                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");            },            success: function (callback) {                    //alert(callback.msg);                if (callback.code == 200)                {                    window.location.reload()                }                else {                    alert(callback.msg)                }            }        });    });</script>{% endblock %}